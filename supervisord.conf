# supervisord.conf
[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log

[program:postgres]
command=/usr/bin/postgres -D /var/lib/postgresql/data
user=postgres
autostart=true
autorestart=true
startretries=5
stdout_logfile=/var/log/postgresql.log
stderr_logfile=/var/log/postgresql-error.log
startsecs=10

[program:backend]
command=node /app/backend/server.js
environment=DB_HOST=localhost,DB_PORT=5432,DB_NAME=bpmn_designer,DB_USER=postgres,DB_PASSWORD=example,PORT=5000,NODE_ENV=production
autostart=true
autorestart=true
startretries=5
stdout_logfile=/var/log/backend.log
stderr_logfile=/var/log/backend-error.log
depends_on=postgres
startsecs=10

[program:nginx]
command=nginx -g "daemon off;"
autostart=true
autorestart=true
startretries=5
stdout_logfile=/var/log/nginx.log
stderr_logfile=/var/log/nginx-error.log
depends_on=backend